/*
 * Pure Black Dark Mode Theme
 */

// Reduce vertical spacing between sections
:root {
    --section-separation: 20px !important; // Reduced from 40px
    --widget-separation: 20px !important; // Match section separation
    --main-top-padding: 20px !important; // Reduced from 35px/50px
}

// Pure black dark mode override with muted, professional colors
:root[data-scheme="dark"] {
    // Pure black background
    --body-background: #000000;
    
   // // Muted accent colors for professional look  
   // --accent-color: #b8b8b8;
   // --accent-color-darker: #9a9a9a;
   // --accent-color-text: #000000;
    --body-text-color: rgba(200, 200, 200, 0.9);
   // 
   // // Scrollbar for black theme
   // --scrollbar-thumb: hsl(0, 0%, 25%);
   // --scrollbar-track: var(--body-background);
   // 
   // // Card styling - transparent backgrounds with subtle line borders
   // --card-background: transparent;
    --card-background-selected: #111111
   // 
   // // Muted, professional text colors
   // --card-text-color-main: #c8c8c8;
   // --card-text-color-secondary: #9a9a9a;
   // --card-text-color-tertiary: #707070;
   // --card-separator-color: #6c6c6c;
   // 
   // // Keep rounded borders for friendlier appearance
   // --card-border-radius: 10px;
    
   // // Article content styling for black background with muted tones
    --blockquote-background-color: rgba(200, 200, 200, 0.03);
    --code-background-color: #1a1a1a;
    --code-text-color: #b0b0b0;
    --table-border-color: #2a2a2a;
    --tr-even-background-color: rgba(200, 200, 200, 0.015);
   // 
   // // Muted link styling for black theme
   // --link-background-color: 200, 200, 200;
   // --link-background-opacity: 0.08;
   // --link-background-opacity-hover: 0.15;
}

/*
 * Universal card design and spacing for both light and dark modes
 * Ensures consistent layout and positioning across themes
 */

// Universal article content styling for both themes
.article-content {
    // Balanced margins on direct children
    > * {
        margin-top: 1.2rem !important;
        margin-bottom: 1.2rem !important;
        
        &:first-child {
            margin-top: 0 !important;
        }
        
        &:last-child {
            margin-bottom: 0 !important;
        }
    }
    
    h1, h2, h3, h4, h5, h6 {
        color: var(--card-text-color-main) !important;
        margin-top: 1.8rem !important;
        margin-bottom: 1rem !important;
        
        &:first-child {
            margin-top: 0 !important;
        }
    }
    
    // h2 gets slightly more space as major section dividers
    h2 {
        margin-top: 2rem !important;
        margin-bottom: 1rem !important;
    }
    
    // Paragraph spacing
    p {
        color: var(--body-text-color);
        line-height: 1.6 !important;
        margin-bottom: 1.2rem !important;
        margin-top: 0 !important;
    }
    
    // Balanced spacing when paragraphs are followed by headings
    p + h1, p + h2, p + h3, p + h4, p + h5, p + h6 {
        margin-top: 1.5rem !important;
    }
    
    // Balanced spacing when lists are followed by headings
    ul + h1, ul + h2, ul + h3, ul + h4, ul + h5, ul + h6,
    ol + h1, ol + h2, ol + h3, ol + h4, ol + h5, ol + h6 {
        margin-top: 1.5rem !important;
    }
    
    // List styling with balanced spacing
    ul, ol {
        color: var(--body-text-color);
        line-height: 1.6 !important;
        margin-bottom: 1.2rem !important;
        
        li {
            margin-bottom: 0.5rem !important;
            
            &::marker {
                color: var(--card-text-color-tertiary);
            }
        }
    }
    
    // Blockquotes with proper width constraints
    blockquote {
        border-left: 2px solid var(--card-text-color-tertiary);
        background-color: var(--blockquote-background-color);
        margin: 1rem 0 !important;
        padding: 0.75rem 1.25rem !important;
        border-radius: var(--tag-border-radius);
        max-width: 100% !important;
        box-sizing: border-box !important;
        overflow-wrap: break-word !important;
        word-wrap: break-word !important;
        
        * {
            max-width: 100% !important;
            overflow-wrap: break-word !important;
        }
    }
    
    // Code blocks
    pre {
        background-color: var(--code-background-color) !important;
        border: 1px solid var(--card-separator-color);
        border-radius: var(--tag-border-radius);
    }
    
    // Inline code
    code {
        background-color: var(--code-background-color);
        border: 1px solid var(--card-separator-color);
        border-radius: var(--tag-border-radius);
        padding: 0.2rem 0.4rem;
    }
    
    // Link styling
    a {
        color: var(--card-text-color-main);
        text-decoration: underline;
        text-decoration-color: var(--card-text-color-tertiary);
        text-underline-offset: 0.2em;
        transition: all 0.2s ease;
        
        &:hover {
            color: var(--card-text-color-main);
            text-decoration-color: var(--card-text-color-secondary);
            opacity: 0.9;
        }
    }
    
    // Strong and emphasis
    strong, b {
        color: var(--card-text-color-main);
    }
    
    em, i {
        color: var(--card-text-color-secondary);
        font-style: italic;
    }
}

// Universal article list styling
.article-list article {
    background-color: var(--card-background) !important;
    border: 2px solid var(--card-separator-color);
    border-radius: var(--card-border-radius) !important;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
    
    &:hover {
        border-color: var(--card-text-color-secondary);
        box-shadow: var(--shadow-l2);
    }
}

// Universal article details styling
.article-details {
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: var(--card-padding);
    gap: 10px;
}

// Universal article title styling
.article-title {
    font-family: var(--article-font-family);
    font-weight: 600;
    margin: 0;
    color: var(--card-text-color-main);
    font-size: 2.2rem;
    
    @include respond(xl) {
        font-size: 2.4rem;
    }
    
    a {
        color: var(--card-text-color-main);
        text-decoration: none;
        
        &:hover {
            color: var(--card-text-color-main);
        }
    }
}

// Article subtitles and descriptions
.article-subtitle,
.section-description {
    font-weight: 400 !important;
    color: var(--card-text-color-secondary) !important;
    line-height: 1.6;
}

// KILL ALL DEFAULT STACK THEME STYLING FOR article-list--compact
// This MUST come first to override the theme defaults
.article-list--compact,
section.article-list--compact,
main .article-list--compact,
.main-container .article-list--compact,
body .article-list--compact,
html .article-list--compact,
html body .article-list--compact {
    // Remove Stack theme's default card styling
    border-radius: 0 !important;
    box-shadow: none !important;
    background-color: transparent !important;
    background: transparent !important;
    border: none !important;
    padding: 0 !important;
    margin: 0 !important;
    
    // Extra insurance
    outline: none !important;
    box-sizing: border-box !important;
}

// Archives page - completely redesign the article list
// Using high specificity to override Stack theme defaults
body.template-archives .article-list--compact,
body.archives .article-list--compact,
.template-archives .article-list--compact,
.archives .article-list--compact {
    // Nuclear reset - remove ALL inherited styles
    all: unset !important;
    display: block !important;
    width: 100% !important;
    
    article {
        // Reset each article completely
        all: unset !important;
        display: block !important;
        margin-bottom: 1.5rem !important;
        
        a {
            // Create clean card design similar to homepage
            display: block !important;
            background-color: rgba(44, 44, 44, 0.5) !important; // Semi-transparent gray
            border: 1px solid rgba(255, 255, 255, 0.08) !important;
            border-radius: 8px !important;
            padding: 18px 24px !important;
            text-decoration: none !important;
            transition: all 0.2s ease !important;
            
            &:hover {
                background-color: rgba(44, 44, 44, 0.8) !important;
                border-color: rgba(255, 255, 255, 0.15) !important;
                transform: translateY(-1px) !important;
            }
        }
        
        .article-details {
            all: unset !important;
            display: block !important;
        }
        
        .article-title {
            all: unset !important;
            display: block !important;
            font-size: 1.8rem !important;
            font-weight: 600 !important;
            color: var(--card-text-color-main) !important;
            margin-bottom: 0.4rem !important;
            font-family: var(--article-font-family) !important;
            line-height: 1.3 !important;
        }
        
        .article-time {
            all: unset !important;
            display: block !important;
            font-size: 1.3rem !important;
            color: var(--card-text-color-tertiary) !important;
            
            time {
                color: inherit !important;
            }
        }
    }
}

// Override Stack theme's fixed 350px x 250px tile dimensions
.article-list--tile {
    article {
        // Force remove Stack's fixed dimensions (height: 350px, width: 250px)
        height: auto !important;
        width: auto !important;
        max-height: none !important;
        max-width: none !important;
        min-height: 0 !important;
        min-width: 0 !important;
        position: static !important;
        
        // Compact styling
        .article-details {
            height: auto !important;
            width: auto !important;
            position: static !important;
            padding: 0 !important;
            background: none !important;
        }
        
        .article-title {
            font-size: 1.4rem !important;
            font-weight: 500 !important;
        }
    }
}

// Subsection-list styling (for archives and category pages)
.subsection-list {
    .article-list--tile {
        // Reset container
        all: unset !important;
        display: flex !important;
        flex-wrap: wrap !important;
        gap: 10px !important;
        width: 100% !important;
        
        article {
            // Nuclear reset for each article
            all: unset !important;
            display: inline-block !important;
            
            a {
                // Create compact tag-like styling
                display: inline-block !important;
                background: #2c2c2c !important;
                border: 1px solid rgba(255, 255, 255, 0.08) !important;
                border-radius: var(--tag-border-radius) !important;
                padding: 8px 20px !important; // Same as tagCloud
                text-decoration: none !important;
                transition: all 0.3s ease !important;
                
                &:hover {
                    background: #333333 !important;
                    border-color: rgba(255, 255, 255, 0.15) !important;
                    transform: translateY(-1px) !important;
                }
            }
            
            .article-details {
                all: unset !important;
                display: block !important;
            }
            
            .article-title {
                all: unset !important;
                display: block !important;
                font-size: 1.4rem !important; // Same as tags
                color: var(--card-text-color-main) !important;
                font-weight: 500 !important;
                line-height: 1 !important;
            }
        }
    }
}

// Dark mode specific color overrides
[data-scheme="dark"] {
    // Dark mode specific background colors
    .article-list article {
        background-color: #2c2c2c !important;
    }
    
    // Archives page compact list dark mode adjustments
    .article-list--compact {
        article {
            // Keep transparent background for cleaner look
            background-color: transparent !important;
        }
    }
    
    // Tile articles in dark mode
    .article-list--tile article,
    .subsection-list .article-list--tile article {
        background-color: #2c2c2c !important; // Match homepage gray
        
        &:hover {
            background-color: #333333 !important;
        }
    }
    //
    //// Section cards (categories, tags, etc.)
    //.section-card {
    //    background-color: transparent !important;
    //    border: 1px solid var(--card-separator-color);
    //    box-shadow: var(--shadow-l1);
    //    border-radius: var(--card-border-radius) !important;
    //    
    //    &:hover {
    //        border-color: var(--card-text-color-secondary);
    //        box-shadow: var(--shadow-l2);
    //    }
    //}
    //
    //// Widget cards in sidebar - restoring original Stack theme style
    //.widget {
    //    background-color: var(--card-background) !important;
    //    box-shadow: var(--shadow-l1);
    //    border: none;
    //    border-radius: var(--card-border-radius) !important;
    //}
    //
    //// Search widget styling - restoring original Stack theme style
    //.search-form {
    //    background-color: var(--card-background) !important;
    //    box-shadow: var(--shadow-l1);
    //    border: none;
    //    border-radius: var(--card-border-radius) !important;
    //    
    //    input {
    //        background-color: transparent;
    //        border: none;
    //        color: var(--card-text-color-main);
    //        
    //        &::placeholder {
    //            color: var(--card-text-color-tertiary);
    //        }
    //    }
    //}
    //
    //// Subsection list items - keep border-bottom as it doesn't affect layout flow
    //.subsection-list .subsection {
    //    border-bottom: 1px solid var(--card-separator-color);
    //    background-color: transparent !important;
    //    
    //    &:last-child {
    //        border-bottom: none;
    //    }
    //    
    //    &:hover {
    //        background-color: rgba(200, 200, 200, 0.02) !important;
    //    }
    //}
    //
    // Dark mode specific backgrounds
    .article-content {
        background-color: #111111 !important;
    }
    
    .main-article {
        background: #111111;
    }
    
    .article-details {
        background: #111111;
    }

//    
//    // Sidebar text enhancements
//    .sidebar {
//        .widget-title {
//            color: var(--card-text-color-main) !important;
//            font-weight: 600;
//            letter-spacing: 0.05em;
//            text-transform: uppercase;
//            font-size: 1.1rem;
//        }
//        
//        .widget-content {
//            color: var(--card-text-color-secondary);
//            line-height: 1.6;
//        }
//    }
//    
//    // Navigation text styling
//    .menu {
//        a {
//            color: var(--card-text-color-main) !important;
//            font-weight: 500;
//            text-decoration: none;
//            
//            &:hover {
//                color: var(--card-text-color-secondary) !important;
//            }
//        }
//    }
//    
//    // Time and metadata text
//    .article-time,
//    .article-translations {
//        color: var(--card-text-color-tertiary) !important;
//        font-size: 1.3rem;
//        font-weight: 400;
//        
//        time {
//            color: var(--card-text-color-tertiary);
//        }
//    }
//    
//    // Category and tag styling
    .article-category,
    .article-tags {
        a {
            color: #ffffff !important;
            background: #2a7d37 !important;
            //font-weight: 500 !important;
            //font-size: 1.2rem;
            //text-decoration: none;
            //
            //&:hover {
            //    color: var(--card-text-color-main) !important;
            //}
        }
    }


//    
//    // Footer text styling
//    .site-footer {
//        color: var(--card-text-color-tertiary);
//        font-size: 1.3rem;
//        
//        a {
//            color: var(--card-text-color-secondary);
//            
//            &:hover {
//                color: var(--card-text-color-main);
//            }
//        }
//    }
//    // Main navigation styling
//    .main-container {
//        background-color: transparent;
//    }
//    
//    // Left sidebar styling
//    .left-sidebar {
//        background-color: transparent !important;
//        
//        .sidebar-inner {
//            background-color: transparent;
//        }
//        
//        // Site info styling
//        .site-info {
//            .site-name {
//                color: var(--card-text-color-main) !important;
//                font-weight: 700;
//            }
//            
//            .site-description {
//                color: var(--card-text-color-secondary) !important;
//            }
//        }
//        
//        // Avatar styling
//        .site-avatar {
//            img {
//                border: 1px solid var(--card-separator-color);
//                border-radius: 50%;
//            }
//        }
//    }
//    
//    // Right sidebar styling - restoring original Stack theme design
//    .right-sidebar {
//        // Keeping the original Stack theme background style
//        
//        .widget {
//            margin-bottom: var(--widget-separation);
//            // Widget title keeps minimal styling
//            .widget-title {
//                border-bottom: 1px solid var(--card-separator-color);
//                padding-bottom: 0.5rem;
//                margin-bottom: 1rem;
//            }
//        }
//        
//        // Tag cloud widget - restore original Stack theme styling
//        .tagCloud {
//            .tagCloud-tags a {
//                background: var(--card-background) !important;
//                box-shadow: var(--shadow-l1);
//                border-radius: var(--tag-border-radius);
//                color: var(--card-text-color-main) !important;
//                
//                &:hover {
//                    box-shadow: var(--shadow-l2);
//                }
//            }
//        }
//        
//        // Archive widget - restore original Stack theme styling
//        .widget.archives {
//            .widget-archive--list {
//                border-radius: var(--card-border-radius);
//                box-shadow: var(--shadow-l1);
//                background-color: var(--card-background);
//            }
//            
//            .archives-year {
//                &:not(:last-of-type) {
//                    border-bottom: 1.5px solid var(--card-separator-color);
//                }
//                
//                a {
//                    span.year {
//                        color: var(--card-text-color-main);
//                    }
//                    
//                    span.count {
//                        color: var(--card-text-color-tertiary);
//                    }
//                }
//            }
//        }
//    }
//    
//    // Pagination styling - use border for consistent positioning
//    .pagination {
//        .page-item {
//            .page-link {
//                background-color: transparent !important;
//                border: 1px solid var(--card-separator-color);
//                border-radius: var(--tag-border-radius) !important;
//                color: var(--card-text-color-secondary) !important;
//                
//                &:hover {
//                    background-color: rgba(200, 200, 200, 0.03) !important;
//                    border-color: var(--card-text-color-secondary);
//                    color: var(--card-text-color-main) !important;
//                }
//            }
//            
//            &.active .page-link {
//                background-color: rgba(200, 200, 200, 0.05) !important;
//                border-color: var(--card-text-color-secondary);
//                color: var(--card-text-color-main) !important;
//            }
//        }
//    }
//    
//    // Article pagination (prev/next)
//    .article-nav {
//        border-top: 1px solid var(--card-separator-color);
//        background-color: transparent;
//        
//        .article-nav-item {
//            background-color: transparent !important;
//            border-radius: 0;
//            
//            .article-nav-link {
//                color: var(--card-text-color-secondary);
//                text-decoration: none;
//                
//                &:hover {
//                    color: var(--card-text-color-main);
//                    background-color: rgba(255, 255, 255, 0.02);
//                }
//                
//                .article-nav-caption {
//                    color: var(--card-text-color-tertiary);
//                    font-size: 1.2rem;
//                }
//                
//                .article-nav-title {
//                    color: var(--card-text-color-secondary);
//                    font-weight: 500;
//                }
//            }
//        }
//    }
//    
//    // Breadcrumb navigation
//    .breadcrumb {
//        background-color: transparent !important;
//        border-bottom: 1px solid var(--card-separator-color);
//        
//        .breadcrumb-item {
//            color: var(--card-text-color-tertiary);
//            
//            a {
//                color: var(--card-text-color-secondary);
//                text-decoration: none;
//                
//                &:hover {
//                    color: var(--card-text-color-main);
//                }
//            }
//            
//            &.active {
//                color: var(--card-text-color-main);
//            }
//        }
//    }
//    
//    // Search results styling
//    .search-page {
//        .search-results {
//            .search-result {
//                border-bottom: 1px solid var(--card-separator-color);
//                background-color: transparent;
//                
//                .search-result-title {
//                    a {
//                        color: var(--card-text-color-main);
//                        
//                        &:hover {
//                            color: var(--card-text-color-secondary);
//                        }
//                    }
//                }
//                
//                .search-result-preview {
//                    color: var(--card-text-color-secondary);
//                }
//            }
//        }
//    }
//    
//
} /* End of [data-scheme="dark"] */

/* ===================================================================
 * Minimalist TOC (Table of Contents) Design - Supabase Style
 * =================================================================== */

// Remove card styling from right sidebar TOC
.right-sidebar {
    // Remove all widget card styling for TOC
    .widget--toc {
        background: transparent !important;
        box-shadow: none !important;
        border: none !important;
        border-radius: 0 !important;
        padding: 0 !important;
        margin: 0 !important;
        
        // Override Stack theme's widget styling
       &.widget {
           background: transparent !important;
           box-shadow: none !important;
       }
    }
}

// Main TOC container styling
.widget--toc {
    position: relative;
    
    // TOC Title - uppercase and minimalist
    .widget-title {
        font-size: 0.75rem !important;
        font-weight: 600 !important;
        text-transform: uppercase !important;
        letter-spacing: 0.05em !important;
        color: var(--card-text-color-tertiary) !important;
        margin-bottom: 1.5rem !important;
        padding: 0 !important;
        border: none !important;
    }
    
    // TOC Navigation container
    #TableOfContents {
        position: relative;
        padding-left: 1.5rem !important;
        background: transparent !important;
        border: none !important;
        
        // Left border indicator
        &::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #111111;
            opacity: 1;
        }
        
        // Dynamic position indicator (controlled by JS via CSS variables)
        &::after {
            content: '';
            position: absolute;
            left: 0;
            top: var(--toc-indicator-top, 0);
            height: var(--toc-indicator-height, 0);
            width: 2px;
            background-color: var(--accent-color);
            transition: all 0.2s ease-out;
            opacity: 1;
        }
    }
}

// TOC list structure - remove default styling
.widget--toc {
    ul, ol {
        list-style: none !important;
        margin: 0 !important;
        padding: 0 !important;
        
        // Nested lists
        ul, ol {
            margin-left: 1rem !important;
            margin-top: 0.25rem !important;
        }
    }
    
    // List items
    li {
        margin: 0 !important;
        padding: 0 !important;
        position: relative;
        
        // Small spacing between items
        + li {
            margin-top: 0.125rem !important;
        }
    }
}

// TOC Links styling
.widget--toc {
    a {
        display: block !important;
        text-decoration: none !important;
        color: var(--card-text-color-tertiary) !important;
        // Use default font size - no override
        line-height: 1.6 !important;
        padding: 0.5rem 0 !important;
        transition: color 0.2s ease !important;
        position: relative;
        
        // Hover state
        &:hover {
            color: var(--card-text-color-main) !important;
        }
        
        // Active/current section styling
        &.active-class {
            color: var(--accent-color) !important;
            font-weight: 500 !important;
        }
    }
    
    // Override Stack theme's active-class positioning that shifts items left
    li.active-class > a {
        margin-left: 0 !important;
        padding-left: 0 !important;
        border-left: none !important;
        // Apply the active styling colors
        color: var(--accent-color) !important;
        font-weight: 500 !important;
    }
    
    // Override for all nested levels (Stack theme applies different margins for each level)
    ul li.active-class > a,
    ol li.active-class > a,
    ul ul li.active-class > a,
    ol ol li.active-class > a,
    ul ul ul li.active-class > a,
    ol ol ol li.active-class > a,
    ul ul ul ul li.active-class > a,
    ol ol ol ol li.active-class > a,
    ul ul ul ul ul li.active-class > a,
    ol ol ol ol ol li.active-class > a {
        margin-left: 0 !important;
        padding-left: 0 !important;
        border-left: none !important;
        // Apply active styling
        color: var(--accent-color) !important;
        font-weight: 500 !important;
    }
    
    // Different levels of headings
    // H2 level (top level in TOC)
    > ul > li > a {
        font-weight: 500 !important;
        color: var(--card-text-color-secondary) !important;
        
        &.active,
        &[aria-current="true"] {
            color: var(--card-text-color-main) !important;
            font-weight: 600 !important;
        }
    }
    
    // H3 and deeper levels - slightly smaller but still readable
    ul ul a {
        font-size: 0.95em !important; // Relative to parent, not absolute
        color: var(--card-text-color-tertiary) !important;
        opacity: 0.9;
        
        &:hover {
            opacity: 1;
            color: var(--card-text-color-secondary) !important;
        }
        
        &.active,
        &[aria-current="true"] {
            opacity: 1;
            color: var(--card-text-color-main) !important;
        }
    }
}

/* JavaScript Integration Requirements:
 * For the dynamic position indicator to work, JavaScript needs to:
 * 1. Track scroll position and active sections
 * 2. Update CSS variables on the #TableOfContents element:
 *    - --toc-indicator-top: The top position of the active section
 *    - --toc-indicator-height: The height of the active section's link
 * 3. Add 'active' class to current section links
 */

// Dark mode specific TOC adjustments
[data-scheme="dark"] {
    .widget--toc {
        .widget-title {
            color: rgba(255, 255, 255, 0.5) !important;
        }
        
        #TableOfContents {
            // Dimmer left border in dark mode
            &::before {
                background-color: #111111;
            }
            
            // Brighter position indicator in dark mode
            &::after {
                background-color: var(--accent-color, #3182ce);
            }
        }
        
        a {
            color: rgba(255, 255, 255, 0.5) !important;
            
            &:hover {
                color: rgba(255, 255, 255, 0.9) !important;
            }
            
            &.active,
            &[aria-current="true"] {
                color: #ffffff !important;
            }
        }
        
        // H2 level in dark mode
        > ul > li > a {
            color: rgba(255, 255, 255, 0.7) !important;
            
            &.active,
            &[aria-current="true"] {
                color: #ffffff !important;
            }
        }
        
        // H3 and deeper in dark mode
        ul ul a {
            color: rgba(255, 255, 255, 0.4) !important;
            
            &:hover {
                color: rgba(255, 255, 255, 0.7) !important;
            }
            
            &.active,
            &[aria-current="true"] {
                color: rgba(255, 255, 255, 0.9) !important;
            }
        }
    }
    
    // Dark mode active-class styling
    li.active-class > a,
    ul li.active-class > a,
    ol li.active-class > a {
        color: #ffffff !important;
    }
}

// Mobile responsiveness for TOC
@media (max-width: 1024px) {
    .widget--toc {
        // Hide TOC on mobile devices by default
        // The Stack theme likely handles this, but ensure it's hidden
        display: none !important;
    }
}

// Tablet and smaller desktop adjustments
@media (max-width: 1280px) {
    .widget--toc {
        // Keep title small on smaller screens
        .widget-title {
            font-size: 0.7rem !important;
        }
        
        a {
            // Use default font size, just adjust padding
            padding: 0.4rem 0 !important;
        }
    }
}

// Remove old TOC background colors that were set in dark mode
[data-scheme="dark"] {
    .TableOfContents {
        background-color: transparent !important;
        background: transparent !important;
    }
    
    .widget--toc {
        background-color: transparent !important;
        background: transparent !important;
        
        // Clean up old font-size override
        font-size: inherit !important;
    }
}

// Universal code highlighting styles for both themes
.article-content .highlight {
    // --- Clean, minimal container with width constraints ---
    background-color: var(--code-background-color) !important;
    border: none !important;
    border-radius: 6px !important;
    box-shadow: none !important;
    margin: 1rem 0 !important;
    padding: 0 !important;
    overflow: hidden !important;
    max-width: 100% !important; // Prevent container from expanding
    width: 100% !important;
    box-sizing: border-box !important;

    // --- Typography ---
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace !important;
    font-size: 1.4rem !important;
    line-height: 1.5 !important;

    // --- Reset internal elements ---
    pre, code {
        background: transparent !important;
        border: none !important;
        margin: 0 !important;
        padding: 0 !important;
        font-size: inherit !important;
        line-height: inherit !important;
        max-width: 100% !important;
    }

    // --- Case 1: Code blocks WITH line numbers ---
    .lntable {
        border-spacing: 0 !important;
        width: 100% !important;
        table-layout: fixed !important; // Force table to respect container width

        .lntd {
            padding: 1rem 0 !important;
            vertical-align: top !important;

            // Line numbers column
            &:first-child {
                width: auto !important;
                padding-left: 1rem !important;
                padding-right: 0 !important;
                white-space: nowrap !important;
                .lnt {
                    color: #5a5a5a !important;
                    user-select: none !important;
                    text-align: right !important;
                    padding-right: 1.5rem !important;
                }
            }

            // Code content column - must scroll
            &:last-child {
                width: 100% !important;
                padding-left: 0 !important;
                padding-right: 1rem !important;
                overflow: hidden !important;
                pre {
                    overflow-x: auto !important;
                    white-space: pre !important;
                    word-wrap: normal !important;
                    display: block !important;
                    max-width: 100% !important;
                }
            }
        }
    }

    // --- Case 2: Code blocks WITHOUT line numbers ---
    > pre {
        padding: 1rem !important;
        overflow-x: auto !important;
        white-space: pre !important;
        word-wrap: normal !important;
        max-width: 100% !important;
    }
}
//    
//    // Comment system styling (if enabled) - keep border-top as it doesn't affect layout
//    .comments {
//        border-top: 1px solid var(--card-separator-color);
//        background-color: transparent;
//        
//        .comment-form {
//            background-color: transparent;
//            
//            input, textarea {
//                background-color: rgba(200, 200, 200, 0.03);
//                border: 1px solid var(--card-separator-color);
//                border-radius: var(--tag-border-radius);
//                color: var(--card-text-color-main);
//                
//                &::placeholder {
//                    color: var(--card-text-color-tertiary);
//                }
//                
//                &:focus {
//                    border-color: var(--card-text-color-secondary);
//                    outline: none;
//                }
//            }
//            
//            button {
//                background-color: transparent;
//                border: 1px solid var(--card-separator-color);
//                border-radius: var(--tag-border-radius);
//                color: var(--card-text-color-main);
//                
//                &:hover {
//                    background-color: rgba(200, 200, 200, 0.05);
//                    border-color: var(--card-text-color-secondary);
//                }
//            }
//        }
//    }
//    
//    // 404 page styling
//    .not-found {
//        color: var(--card-text-color-secondary);
//        
//        h1 {
//            color: var(--card-text-color-main);
//        }
//    }
//    
//    // Print media query for dark mode
//    @media print {
//        * {
//            background-color: white !important;
//            color: black !important;
//            border-color: black !important;
//        }
//    }
//}
//


// Custom styles for homepage
//.homepage {
//    // Ensure homepage content has consistent styling
//    .main-article {
//        margin-bottom: var(--section-separation);
//        
//        .article-header {
//            margin-bottom: 2rem;
//            
//            .article-title {
//                a {
//                    color: var(--card-text-color-main);
//                    text-decoration: none;
//                    pointer-events: none; // Make title non-clickable on homepage
//                    
//                    &:hover {
//                        color: var(--card-text-color-main);
//                    }
//                }
//            }
//        }
//        
//        .article-content {
//            // Ensure consistent typography
//            h2 {
//                margin-top: 2rem;
//                margin-bottom: 1rem;
//            }
//            
//            ul {
//                margin: 1rem 0;
//            }
//        }
//    }
//    
//    // Section title for latest posts
//    .section-title {
//        margin: calc(var(--section-separation) / 2) 0;
//        color: var(--card-text-color-main);
//        font-weight: bold;
//        text-transform: uppercase;
//        letter-spacing: 1px;
//        font-size: 1.2rem;
//        
//        &:first-of-type {
//            margin-top: 0;
//        }
//    }
//}

// Add horizontal line under each menu item
#main-menu > li:not(.menu-bottom-section) {
    position: relative;
    padding-bottom: 5px; // Reduced space for the line

    &::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 1px; // Minimalistic 1px line
        background-color: #111111;
    }
}


/*
 * Override for Category/Taxonomy pages to display as a simple list instead of large tiles.
 */
body.list.category .article-list--tile article,
body.list.tag .article-list--tile article {
    // Reset card styles
    border: none !important;
    background: transparent !important;
    padding: 0 !important;
    margin-bottom: 1rem !important; // Add some space between items
    box-shadow: none !important;

    &:hover {
        border: none !important;
        box-shadow: none !important;
        background: var(--card-background-selected) !important;
    }

    a {
        text-decoration: none; // Remove underline from the whole link block
    }
}

body.list.category .article-list--tile .article-details,
body.list.tag .article-list--tile .article-details {
    // Reset padding and layout
    padding: 0.5rem 1rem !important;
    gap: 0 !important;
}

/*
 * Override for Category/Tag pages to display subsections as a simple list.
 */
body.list.category .subsection-list .article-list--tile,
body.list.tag .subsection-list .article-list--tile {
    display: block; // Override flex to stack items vertically
    padding-bottom: 0; // Remove extra padding
    overflow-x: visible; // Allow content to wrap if needed
}

body.list.category .subsection-list .article-list--tile article,
body.list.tag .subsection-list .article-list--tile article {
    // Reset article card styles
    width: auto !important; // Allow full width
    height: auto !important; // Allow height to adjust to content
    margin-right: 0 !important; // Remove horizontal margin
    flex-shrink: 1 !important; // Allow shrinking
    border: none !important;
    background: transparent !important;
    box-shadow: none !important;
    padding: 0 !important; // Remove padding from article itself
    margin-bottom: 0.5rem !important; // Small vertical spacing between list items

    &:hover {
        background-color: var(--card-background-selected) !important;
        box-shadow: none !important;
    }

    a {
        display: block; // Make the link fill the entire article area
        padding: 0.5rem 1rem; // Add some padding to the clickable area
        text-decoration: none; // Remove underline from the whole link block
        color: var(--card-text-color-secondary) !important; // Default text color
        font-size: 1.6rem !important; // Set desired font size
        font-weight: 400 !important; // Less bold
    }

    .article-details {
        padding: 0 !important; // Remove padding from article-details
        gap: 0 !important; // Remove gap
    }

    .article-title {
        font-size: inherit !important; // Inherit from parent 'a' tag
        font-weight: inherit !important; // Inherit from parent 'a' tag
        color: inherit !important; // Inherit from parent 'a' tag
        margin: 0 !important; // Remove margin
    }
}

// Ensure hover state for the link within the article
body.list.category .subsection-list .article-list--tile article a:hover,
body.list.tag .subsection-list .article-list--tile article a:hover {
    color: var(--card-text-color-main) !important; // Highlight on hover
}
body.list.tag .article-list--tile .article-title {
    // Greatly reduce font size for a list-like appearance
    font-size: 1.6rem !important; // Match base font size
    font-weight: 400 !important; // Make it less bold
    color: var(--card-text-color-secondary) !important; // Use a secondary color

    &:hover {
        color: var(--card-text-color-main) !important; // Highlight on hover
    }
}

// Additional overrides for archives template with extreme specificity
body.template-archives {
    .archives-group {
        .article-list--compact {
            // Complete reset of container
            all: unset !important;
            display: block !important;
            width: 100% !important;
            border: none !important;
            box-shadow: none !important;
            background: none !important;
            background-color: transparent !important;
            border-radius: 0 !important;
            padding: 0 !important;
            margin: 0 !important;
            
            // Remove any pseudo-elements
            &::before, &::after {
                display: none !important;
                content: none !important;
            }
            
            // Ensure articles display properly
            article {
                display: block !important;
                margin-bottom: 1rem !important;
            }
        }
    }
    
    // Extra insurance - target with ID selector too
    #2025 .article-list--compact,
    [id*="20"] .article-list--compact {
        box-shadow: none !important;
        border: none !important;
        background: transparent !important;
    }
    
    // Fix subsection-list on archives page specifically
    .subsection-list {
        // Reset the container
        all: unset !important;
        display: block !important;
        margin-bottom: 2rem !important;
        
        .article-list--tile {
            all: unset !important;
            display: flex !important;
            flex-wrap: wrap !important;
            gap: 10px !important;
            
            article {
                all: unset !important;
                display: inline-block !important;
                height: auto !important;
                width: auto !important;
                margin: 0 !important;
                padding: 0 !important;
                
                // Override Stack theme's fixed dimensions
                &.has-image {
                    height: auto !important;
                }
            }
        }
    }
}

// Fix for category/tag pages that have section-card headers
.section-card {
    // Style the header card like homepage articles
    background-color: #2c2c2c !important;
    border: 1px solid rgba(255, 255, 255, 0.08) !important;
    border-radius: var(--card-border-radius) !important;
    padding: 20px 30px !important;
    margin-bottom: 2rem !important;
    
    .section-details {
        .section-count {
            all: unset !important;
            display: block !important;
            font-size: 1.2rem !important;
            color: var(--card-text-color-tertiary) !important;
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
            margin-bottom: 0.5rem !important;
        }
        
        .section-term {
            all: unset !important;
            display: block !important;
            font-size: 2.4rem !important;
            font-weight: 600 !important;
            color: var(--card-text-color-main) !important;
            font-family: var(--article-font-family) !important;
        }
    }
}

// Universal fix for ALL pages with section-card (categories, tags, etc)
// Using attribute selectors to catch any page with these structures
section.article-list--compact,
.section-card + section.article-list--compact,
main section.article-list--compact,
[class*="category"] .article-list--compact,
[class*="tag"] .article-list--compact,
body .article-list--compact {
    // Nuclear reset
    all: unset !important;
    display: block !important;
    width: 100% !important;
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    
    article {
        all: unset !important;
        display: block !important;
        margin-bottom: 1.5rem !important;
        
        a {
            display: block !important;
            background-color: rgba(44, 44, 44, 0.5) !important;
            border: 1px solid rgba(255, 255, 255, 0.08) !important;
            border-radius: 8px !important;
            padding: 18px 24px !important;
            text-decoration: none !important;
            transition: all 0.2s ease !important;
            
            &:hover {
                background-color: rgba(44, 44, 44, 0.8) !important;
                border-color: rgba(255, 255, 255, 0.15) !important;
                transform: translateY(-1px) !important;
            }
        }
        
        .article-details {
            all: unset !important;
            display: block !important;
        }
        
        .article-title {
            all: unset !important;
            display: block !important;
            font-size: 1.8rem !important;
            font-weight: 600 !important;
            color: var(--card-text-color-main) !important;
            margin-bottom: 0.4rem !important;
            font-family: var(--article-font-family) !important;
            line-height: 1.3 !important;
        }
        
        .article-time {
            all: unset !important;
            display: block !important;
            font-size: 1.3rem !important;
            color: var(--card-text-color-tertiary) !important;
            
            time {
                color: inherit !important;
            }
        }
    }
}

// GLOBAL OVERRIDE - Apply to ALL article-list--compact that aren't on archives page
// This catches category, tag, and any other pages
body:not(.template-archives) section.article-list--compact,
body:not(.template-archives) .article-list--compact,
main section.article-list--compact {
    // Complete container reset
    all: unset !important;
    display: block !important;
    width: 100% !important;
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    padding: 0 !important;
    margin: 0 !important;
    
    // Also reset with specific properties in case all: unset doesn't work
    background-color: transparent !important;
    border-radius: 0 !important;
}

// Force override Stack theme's article list styles EVERYWHERE
html body .main-container section.article-list--compact article,
html body section.article-list--compact article,
.article-list--compact article {
    // Complete reset
    all: unset !important;
    display: block !important;
    width: 100% !important;
    height: auto !important;
    max-height: none !important;
    position: static !important;
    margin: 0 0 1.5rem 0 !important;
    padding: 0 !important;
    background: none !important;
    border: none !important;
    
    // The link is the actual card
    & > a {
        all: unset !important;
        display: block !important;
        background-color: rgba(44, 44, 44, 0.5) !important;
        border: 1px solid rgba(255, 255, 255, 0.08) !important;
        border-radius: 8px !important;
        padding: 18px 24px !important;
        text-decoration: none !important;
        cursor: pointer !important;
        transition: all 0.2s ease !important;
        
        &:hover {
            background-color: rgba(44, 44, 44, 0.8) !important;
            border-color: rgba(255, 255, 255, 0.15) !important;
            transform: translateY(-1px) !important;
        }
        
        .article-details {
            all: unset !important;
            display: block !important;
            
            .article-title {
                all: unset !important;
                display: block !important;
                font-size: 1.8rem !important;
                font-weight: 600 !important;
                color: var(--card-text-color-main) !important;
                margin-bottom: 0.4rem !important;
                font-family: var(--article-font-family) !important;
                line-height: 1.3 !important;
            }
            
            .article-time {
                all: unset !important;
                display: block !important;
                font-size: 1.3rem !important;
                color: var(--card-text-color-tertiary) !important;
                
                time {
                    all: unset !important;
                    font-size: inherit !important;
                    color: inherit !important;
                }
            }
        }
    }
}

// FINAL ULTIMATE OVERRIDE - Target category/tag pages by structure
// Force styling on any page that has a header followed by article-list--compact
header + section.article-list--compact,
header + .article-list--compact,
.section-card + section,
.section-card ~ section,
.section-term ~ * .article-list--compact {
    // NUCLEAR OPTION - Remove everything
    all: initial !important;
    display: block !important;
    width: 100% !important;
    max-width: 100% !important;
    background: transparent !important;
    background-color: transparent !important;
    border: 0 !important;
    border-radius: 0 !important;
    box-shadow: none !important;
    padding: 0 !important;
    margin: 0 !important;
    outline: 0 !important;
}

// Target articles inside any section.article-list--compact
section.article-list--compact > article {
    all: initial !important;
    display: block !important;
    margin-bottom: 1rem !important;
    
    > a {
        all: initial !important;
        display: block !important;
        background-color: #2c2c2c !important;
        border: 1px solid rgba(255, 255, 255, 0.08) !important;
        border-radius: 8px !important;
        padding: 18px 24px !important;
        text-decoration: none !important;
        color: inherit !important;
        cursor: pointer !important;
        
        &:hover {
            background-color: #333333 !important;
            border-color: rgba(255, 255, 255, 0.12) !important;
        }
        
        .article-details {
            all: initial !important;
            display: block !important;
            
            * {
                all: initial !important;
                display: block !important;
                font-family: inherit !important;
            }
            
            .article-title {
                font-size: 1.8rem !important;
                font-weight: 600 !important;
                color: #e0e0e0 !important;
                margin-bottom: 0.4rem !important;
                line-height: 1.3 !important;
            }
            
            .article-time {
                font-size: 1.3rem !important;
                color: #999999 !important;
            }
        }
    }
} 


// WORKING OVERRIDE for category/tag pages
// Target the exact selectors without using all: initial
section.article-list--compact {
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    padding: 0 !important;
    border-radius: 0 !important;
    
    > article {
        background: transparent !important;
        border: none !important;
        box-shadow: none !important;
        height: auto !important;
        width: auto !important;
        padding: 0 !important;
        margin: 0 0 1rem 0 !important;
        
        > a {
            display: block !important;
            background-color: #2c2c2c !important;
            border: 1px solid rgba(255, 255, 255, 0.08) !important;
            border-radius: 8px !important;
            padding: 18px 24px !important;
            text-decoration: none !important;
            transition: all 0.2s ease !important;
            
            &:hover {
                background-color: #333333 !important;
                border-color: rgba(255, 255, 255, 0.12) !important;
            }
            
            .article-title {
                font-size: 1.8rem !important;
                color: #e0e0e0 !important;
                margin-bottom: 0.4rem !important;
            }
            
            .article-time {
                font-size: 1.3rem !important;
                color: #999999 !important;
            }
        }
    }
}
